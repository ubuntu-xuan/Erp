{% extends "base.html" %}

{% block title %}编写送货单{% endblock%}



{% block styles %}
    {{ super() }}
    <style >
      .commission{font-size:14px;width:150px;}
      .table-head{font-size:14px;}
 

      
         
 
      .table-bordered th,  
      .table-bordered td {  
          border: 0.5px solid #000 !important;height:25px!important;font-size:10.5pt !important; }

      


    </style> 

{% endblock %}

{% block content %}
        <!-- page content -->
        <div class="right_col" role="main">
            <div class="row">
                <div class="col-md-11">
                    <h4 align="center" >编辑送货单</h4>
                </div>
            </div>
            <form class="form" id='form' role="form" method="post" " >
            <div id="toolbar">
                 <button type='button' id="save" class="btn btn-success" >
                     <i class="glyphicon glyphicon-plus"></i> 保存

                 <button type='button' id="print" class="btn btn-primary popover-destroy" >
                     <i class="glyphicon glyphicon-print"></i> 打印

              <!--   <button type='button' id="return" class="btn btn-warning" >
                     <i class="glyphicon glyphicon-backward"></i> 返回 -->

            </div>

            <br>
            <div class="row" >
                <div class="col-md-12" >                  
                       <div >佣金结算:<input class="commission" name="commission" type='test' value="{{ commission }}" />¥ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
                       销售代表:<span id='saler'> {{saler}} </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 送货单编号: <span id="delivery_no"> {{ delivery_no }} </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 送货日期:<span id="delivery_date">{{delivery_date }}</span>
                </div>

        
            </div>
            <div class="row" >
                    <div class="col-md-12" >

                        
                        <br>
                        <div class="fixed-table-container" >
                            <div class="fixed-table-header" >
                                <table class="table table-hover  " id="table" >
                                    
   			           <thead>
      				   <tr>
         			       <th>id</th>
        			       <th>产品名称</th>
         			       <th>数量</th>
        			       <th>单位</th>
         			       <th>单价¥</th>
        			
                                       <th>备注</th>
      				   </tr>
   				   </thead>


   				<tbody>
      				<tr>
         			    <td >01</td>
         			    <td><input class="form-control" type='test' name='production1' value='{{ production1 }}' /></td>
         			    <td><input class="form-control" type='test' name='num1' value='{{ num1 }}' /></td>
         			    <td><input class="form-control" type='test' name='unit1' value='{{ unit1 }}' /></td>
         			    <td><input class="form-control" type='test' name='unit_price1' value='{{ unit_price1 }}'/></td>
         		
         			    <td><input class="form-control" type='test' name='remark1' value='{{ remark1 }}' /></td>
      				</tr>
      				<tr>
         			    <td >02</td>
         			    <td><input class="form-control" type='test' name='production2' value='{{ production2 }}'/></td>
         			    <td><input class="form-control" type='test' name='num2' value='{{ num2 }}' /></td>
         			    <td><input class="form-control" type='test' name='unit2' value='{{ unit2 }}' /></td>
         			    <td><input class="form-control" type='test' name='unit_price2' value='{{ unit_price2 }}'/></td>
         		
         			    <td><input class="form-control" type='test' name='remark2'  value='{{ remark2 }}'/></td>
      				</tr>
      				<tr>
         			    <td >03</td>
         			    <td><input class="form-control" type='test' name='production3' value='{{ production3 }}'/></td>
         			    <td><input class="form-control" type='test' name='num3' value='{{ num3 }}' /></td>
         			    <td><input class="form-control" type='test' name='unit3' value='{{ unit3 }}'  /></td>
         			    <td><input class="form-control" type='test' name='unit_price3' value='{{ unit_price3 }}'/></td>
         		
         			    <td><input class="form-control" type='test' name='remark3'  value='{{ remark3 }}'/></td>
      				</tr>
       				<tr>
         			    <td >04</td>
         			    <td><input class="form-control" type='test' name='production4' value='{{ production4 }}'/></td>
         			    <td><input class="form-control" type='test' name='num4' value='{{ num4 }}' /></td>
         			    <td><input class="form-control" type='test' name='unit4' value='{{ unit4 }}'  /></td>
         			    <td><input class="form-control" type='test' name='unit_price4' value='{{ unit_price4 }}'/></td>
         		
         			    <td><input class="form-control" type='test' name='remark4'  value='{{ remark4 }}'/></td>
      				</tr>
       				<tr>
         			    <td >05</td>
         			    <td><input class="form-control" type='test' name='production5' value='{{ production5 }}'/></td>
         			    <td><input class="form-control" type='test' name='num5' value='{{ num5 }}' /></td>
         			    <td><input class="form-control" type='test' name='unit5' value='{{ unit5 }}'  /></td>
         			    <td><input class="form-control" type='test' name='unit_price5' value='{{ unit_price5 }}'/></td>
         		
         			    <td><input class="form-control" type='test' name='remark5'  value='{{ remark5 }}'/></td>
      				</tr>
      				<tr>
         			    <td >06</td>
         			    <td><input class="form-control" type='test' name='production6' value='{{ production6 }}'/></td>
         			    <td><input class="form-control" type='test' name='num6' value='{{ num6 }}' /></td>
         			    <td><input class="form-control" type='test' name='unit6' value='{{ unit6 }}'  /></td>
         			    <td><input class="form-control" type='test' name='unit_price6' value='{{ unit_price6 }}'/></td>
         		
         			    <td><input class="form-control" type='test' name='remark6'  value='{{ remark6 }}'/></td>
      				</tr>
   				</tbody>


                                </table>

       
  
                            </div>
                        </div>
                    </div>
            </form>
            </div>
        </div>
        </div>
        <!-- /page content -->

        <!-- footer content -->
        <footer>

          <div class="clearfix"></div>
        </footer>
        <!-- /footer content -->
      </div>
    </div>
    

            <!-- 模态框（Modal） -->
	<div class="modal fade" id="Delivery_Modal" tabindex="-1" role="dialog"
   	    aria-labelledby="myModalLabel" aria-hidden="true">
   	<div class="modal-dialog" style="width:950px;">
            <div class="modal-content">
                <div class="modal-header">
            	<button type="button" class="close"
               	    data-dismiss="modal" aria-hidden="true">
                    &times;
            	</button>
            	<h4 class="modal-title" id="myModalLabel">
               	    送货单
            	</h4>
            </div>
            <div class="modal-body">
                
            <!-- page content -->
            <div class="center_col" role="main">

                <form class="form" id='form' role="form" method="post"  >
                   <!-- divToPrint -->
                   <div id='divToPrint'>
                   <div class="container">
   		       <div class="row">
      			   <div class="col-md-6">
                               <h4 id='company_name'>广东瑞恩科技有限公司</h4> 
                           </div>
      			   <div class="col-md-6">
                               <h6 id='order'><strong>[货物验收单]<br>No.{{ delivery_no }}</strong></h6>
                           </div>
    
   		       </div>
   		       <div class="row">
                           <div class="col-md-12">
                               <p><span class='delivery_message'>广东省东莞市南城区体育路5号健升大厦1502室     <span id='purchase_order'>采购单号：{{ purchase_order }}</span> <br>Tel:0769-21680186 Fax:0769-22823986<br>客户名称:{{ client_name }}</span> 
                                  <br><span class='delivery_message'>客户地址:{{ client_adress }}</span> <span id='date'>送货日期:{{delivery_date}}</span>  </p> 
                           </div> 
                       </div>

   		       <div class="row">
                          <div class="col-md-12" > 
                           <table bordercolor="#000" border=1px borderstyle=solid  id='printtable'>
                              <tbody id='table_head' >
   				 
      				      <tr  height=45px>
         			         <td width=50px >编号</td>
         			         <td width=320px>产品名称</td>
         			         <td width=80px>数量</td>
         			         <td width=80px>单位</td>
         			         <td width=120px>单价(¥)</td>
         			         <td width=120px>金额(¥)</td>
         			         <td>备注</td>
      				      </tr>
   				
      				      <tr height=45px>
         			         <td> {%if production1!=''%}01{% endif %}</td>
         			         <td>{{ production1 }}</td>
         			         <td>{{ num1 }}</td>
         			         <td>{{ unit1 }}</td>
         			         <td>{{ unit_price1 }}</td>
         			         <td>{%if production1!=''%}{{ amount1 }}{% endif %}</td>
         			         <td>{{ remark1 }}</td>
      				      </tr>
      				      <tr height=45px>
         			         <td>{%if production2!=''%}02{% endif %}</td>
         			         <td>{{ production2 }}</td>
         			         <td>{{ num2 }}</td>
         			         <td>{{ unit2 }}</td>
         			         <td>{{ unit_price2 }}</td>
         			         <td>{%if production2!=''%}{{ amount2 }}{% endif %}</td>
         			         <td>{{ remark2 }}</td>
      				      </tr>
      				      <tr height=45px>
         			         <td> {%if production3!=''%}03{% endif %}</td>
         			         <td>{{ production3 }}</td>
         			         <td>{{ num3 }}</td>
         			         <td>{{ unit3 }}</td>
         			         <td>{{ unit_price3 }}</td>
         			         <td>{%if production3!=''%}{{ amount3 }}{% endif %}</td>
         			         <td>{{ remark3 }}</td>
      				      </tr>
      				      <tr height=45px>
         			         <td>{%if production4!=''%}04{% endif %}</td>
         			         <td>{{ production4 }}</td>
         			         <td>{{ num4 }}</td>
         			         <td>{{ unit4 }}</td>
         			         <td>{{ unit_price4 }}</td>
         			         <td>{%if production4!=''%}{{ amount4 }}{% endif %}</td>
         			         <td>{{ remark4 }}</td>
      				      </tr>
      				      <tr height=45px>
         			         <td>{%if production5!=''%}05{% endif %}</td>
         			         <td>{{ production5 }}</td>
         			         <td>{{ num5 }}</td>
         			         <td>{{ unit5 }}</td>
         			         <td>{{ unit_price5 }}</td>
         			         <td>{%if production5!=''%}{{ amount5 }}{% endif %}</td>
         			         <td>{{ remark5 }}</td>
      				      </tr>
      				      <tr height=45px>
         			         <td>{%if production6!=''%}06{% endif %}</td>
         			         <td>{{ production6 }}</td>
         			         <td>{{ num6 }}</td>
         			         <td>{{ unit6 }}</td>
         			         <td>{{ unit_price6 }}</td>
         			         <td>{%if production6!=''%}{{ amount6 }}{% endif %}</td>
         			         <td>{{ remark6 }}</td>
      				      </tr>
      				      <tr height=45px>
         			         <td colspan="2">金额合计(大写):</td>
         			         <td colspan="3"></td>
         			         <td>小写金额:</td>
         			         <td>¥{{ all_amount }}</td>
         			  
      				      </tr>
                              </tbody>
                          </table>
                         </div>
                       </div>
                      
   		          <div class="row">
                              <div class="col-md-12">
                          <br>
                                  <p id='unit'>发货单位: <span id='reception'>收货人:</span>  <span> </span> </p>
                              </div> 
              
                          </div>
                          <br>  
                          <br>  
   		          <div class="row">
                              <div class="col-md-10">
                                  <p id='tablefooter'>第一联..存根(白)&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp第二联..顾客(红)&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp第三联..回单(蓝)&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp第四联..记帐(黄) </p>
                              </div> 
                          </div>
                       </div>
		   </div>


	    </div>
            <!-- /divToPrint -->
                   
            </form>
            </div>
        
        </div>
        
        <!-- /page content -->



            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default"
                   data-dismiss="modal">关闭
                </button>
                <button type="button" id='modal_print' class="btn btn-primary">
                  <i class="glyphicon glyphicon-print"></i> 打印
            	</button>
            </div>
          </div><!-- /.modal-content -->
	</div><!-- /.modal -->


{% endblock%}

{% block scripts %}
    {{ super() }}
        <script>
	$(function () { $('.popover-show').popover('show');});
        $(function () { $('.popover-hide').popover('hide');});
        $(function () { $('.popover-destroy').popover('destroy');});
        $(function () { $('.popover-toggle').popover('toggle');});
        $(function () { $(".popover-options a").popover({html : true });});
	</script>
    <script>
    $(document).ready(function(){

          function GetRequest() {  
                var url = location.search; //获取url中"?"符后的字串
                var theRequest = new Object();  
                if (url.indexOf("?") != -1) {  
                    var str = url.substr(1);  
                    strs = str.split("&");  
                    for (var i = 0; i < strs.length; i++) {  
                        theRequest[strs[i].split("=")[0]] = (strs[i].split("=")[1]);  
                    }  
                }  
                return theRequest;  
           }
           
           var Request = new Object();  
           Request = GetRequest();

           var saler = $("#saler").text();
           var delivery_no = $("#delivery_no").text();
           var delivery_date = $("#delivery_date").text();

              $.ajax({
                    type: "post",
                    url: "/edit_delivery",
                    async: false,
                    data:{  

                        'saler':saler,
                        'delivery_no':delivery_no,
                        'delivery_date':delivery_date,
                        'edit_delivery_save':Request["in"],
                
                    },
                    dataType: 'JSON',
                    success: function (data, status) {
                        if (status == "success") {
                            alert('提交数据成功');
                        }
                    },
                    complete: function () {
                    }
                });




           //alert(delivery_no)
          $('#save').click(function() {
              //返回销售代表


              $.ajax({
                    type: "post",
                    url: "/edit_delivery",
                    async: false,
                    data:{  
                        'edit_delivery_save':Request["in"],

                    
                    },
                    dataType: 'JSON',
                    success: function (data, status) {
                        if (status == "success") {
                            alert('提交数据成功');
                        }
                    },
                    complete: function () {
                    }
                });

               $('#form').submit();


               
               //window.location.href = "{{ url_for('main.production_orders') }}";
               
          }) 


          $('#print').click(function(){
              $('#Delivery_Modal').modal('toggle'); 
          })   


          $('#return').click(function(){
              window.location.href = "{{ url_for('main.delivery_orders') }}";
          })       
          









          function PageSetup_Null()  
	  {  
	      try{  
                   
 		   var RegWsh = new ActiveXObject("WScript.Shell") ;  
 		   hkey_key="header" ;  
 		   RegWsh.RegWrite(hkey_root+hkey_path+hkey_key,"") ;  
 	           hkey_key="footer" ;  
 		   RegWsh.RegWrite(hkey_root+hkey_path+hkey_key,"") ;  
 	        }  
		catch(e){}  
	  } 


          $('#modal_print').click(function(){
              
              $('#divToPrint').jqprint({
                debug: true,            
                importCSS: true,         
                printContainer: true,    
                operaSupport: false  

             });  
          })


    })


    </script> 

{% endblock%}


  </body>
</html>
